<html>
  <meta charset="utf8" />
  <title>Spectrum</title>
  <style>
    .btn {
      color: white;
      background: #666;
      border: 0;
      padding: 15px;
    }
    .btn:hover {
      background: #aaa;
    }

    @keyframes logo-anim {
      0% {
        stroke: black;
        transform: skew(0deg, 0deg);
      }
      50% {
        stroke: white;
      }
      58% {
        transform: skew(0deg, 0deg);
        filter: blur(0);
      }
      60% {
        stroke: white;
        transform: skew(-20deg, 0deg);
        filter: blur(4px);
      }
      62% {
        transform: skew(20deg, 0deg);
      }
      64% {
        transform: skew(0deg, 0deg);
        filter: blur(0);
      }
      100% {
        stroke: black;
        transform: skew(0deg, 0deg);
      }
    }
    @keyframes glitch {
      0% {
        transform: translate(0);
      }
      20% {
        transform: translate(-8px, 8px);
      }
      40% {
        transform: translate(-8px, -8px);
      }
      60% {
        transform: translate(8px, 8px);
      }
      80% {
        transform: translate(8px, -8px);
      }
      100% {
        transform: translate(0);
      }

    }


    .logo {
      position: relative;
      left: -30%;
      top: -30%;
      animation: logo-anim 3s infinite;
    }

    body {
      width: 100vw;
      margin: 0;
      padding: 0;
      height: 100vh;
      background-color: #000;
    }
    #container {
      height: 40vmin;
      width: 40vmin;
      position: absolute;
      top: 50vh;
      left: 50vw;
    }
    #startButton {
      position: absolute;
      left: calc(50vw - 100px);
      top: calc(50vh - 25px);
      width: 200px;
      font-size: 26px;
      font-weight: lighter;
      color: white;
      background: transparent;
      border: 0;
      padding-top: 10px;
      padding-bottom: 20px;
      border-bottom: 3px solid black;
      transition: border-bottom-color 0.2s ease;
      cursor: pointer;
    }

    #startButton:hover {
      border-bottom-color: white;
    }
    .dn {
      display: none;
    }

    .menuItem {
      padding: 8px 0;
      display: flex;
      align-items: center;
      cursor: pointer;
    }
    .menuItem span {
      color: white;
      font-weight: lighter;
      font-family: Helvetica, serif;
      padding-left: 10px;
    }
    .menuItem:hover span {
      color: #89216b;
    }
  </style>
  <body>
    <div class="menu">
      <div class="menuItem" onclick="changeColor('#659999', '#f4791f')">
        <svg
          height="40"
          viewBox="-12 0 512 512.003"
          width="40"
          xmlns="http://www.w3.org/2000/svg"
          fill="white"
        >
          <path
            d="M483.602 367.895c-3.04-1.43-74.95-34.942-124.13-34.942-4.605 0-9.363.293-14.206.824 13.156-8.703 24.117-17.507 32.761-26.351 17.805-18.207 36.23-47.2 54.77-86.168 13.7-28.793 22.137-51.98 22.488-52.953a7.501 7.501 0 0 0-9.707-9.57c-.953.363-23.64 9-51.808 23.015-38.122 18.973-66.48 37.828-84.293 56.047-5.055 5.172-10.11 11.18-15.145 17.98 5.27-22.66 7.938-42.89 7.938-60.476 0-75.387-49.368-186.192-51.47-190.875C249.59 1.734 246.91 0 243.958 0s-5.633 1.734-6.84 4.43c-.281.617-27.957 62.593-42.492 124.668a7.499 7.499 0 0 0 5.594 9.011 7.502 7.502 0 0 0 9.011-5.593c9.782-41.77 25.688-83.578 34.723-105.743 13.727 33.692 43.313 112.79 43.313 168.532 0 55.715-29.645 129.976-43.313 161.246-13.664-31.254-43.308-105.488-43.308-161.246 0-9.586.89-20.438 2.648-32.242a7.5 7.5 0 0 0-6.313-8.524 7.498 7.498 0 0 0-8.523 6.316c-1.867 12.536-2.812 24.125-2.812 34.45 0 19.078 3.16 39.898 7.914 60.437-5.028-6.785-10.075-12.777-15.125-17.941-17.809-18.219-46.168-37.074-84.29-56.047-28.167-14.02-50.855-22.652-51.808-23.016a7.504 7.504 0 0 0-9.711 9.57c.352.973 8.793 24.16 22.492 52.954 18.54 38.968 36.965 67.96 54.766 86.168 8.644 8.84 19.601 17.644 32.758 26.351-4.84-.531-9.598-.824-14.2-.824-13.105 0-29.015 2.398-47.3 7.133a7.5 7.5 0 0 0-5.38 9.14c1.04 4.008 5.13 6.422 9.141 5.38 17.055-4.415 31.703-6.653 43.54-6.653 32.73 0 75.765 16.977 97.788 26.73-22.011 9.754-65.023 26.727-97.789 26.727-32.738 0-78.441-16.937-102.132-26.734 7.863-3.254 18.144-7.297 29.539-11.227a7.495 7.495 0 0 0 4.644-9.531c-1.347-3.918-5.617-5.996-9.535-4.649-26.008 8.97-45.812 18.235-46.645 18.625A7.494 7.494 0 0 0 0 374.688c0 2.906 1.68 5.55 4.313 6.785 3.039 1.43 74.949 34.941 124.128 34.941 10.153 0 21.047-1.426 31.97-3.703a96.252 96.252 0 0 0-1.79 1.777c-26.633 27.239-47.754 85.016-48.64 87.461-1 2.754-.301 5.84 1.785 7.895a7.491 7.491 0 0 0 7.925 1.672c2.391-.907 58.93-22.532 85.586-49.793 17.172-17.567 30.875-46.582 38.68-65.688 7.8 19.106 21.508 48.121 38.68 65.688 26.652 27.261 83.191 48.886 85.586 49.793a7.497 7.497 0 0 0 7.925-1.672 7.495 7.495 0 0 0 1.786-7.895c-.887-2.445-22.012-60.222-48.641-87.46a96.57 96.57 0 0 0-1.793-1.778c10.926 2.273 21.82 3.703 31.973 3.703 49.18 0 121.09-33.516 124.129-34.941a7.498 7.498 0 0 0 4.308-6.79 7.495 7.495 0 0 0-4.308-6.788zM320.203 248.28c29.613-30.285 86.813-57.047 114.668-68.957-11.598 28.41-37.848 87.219-67.57 117.617-16.176 16.543-42.676 33.871-76.637 50.098-.012.008-23.008 8.633-31.555 12.348a739.783 739.783 0 0 0 17.293-43.813c.121-.195.235-.398.336-.61 14.39-29.468 29.016-51.902 43.465-66.683zm-123.2 98.684c-.194-.121-60.355-33.625-76.39-50.024-29.722-30.398-55.972-89.207-67.57-117.617 27.86 11.91 85.059 38.672 114.668 68.957 14.527 14.86 29.219 37.446 43.672 67.117a727.686 727.686 0 0 0 17.387 43.973c-8.606-3.742-19.614-8.215-31.766-12.406zm-2.452 104.27c-16.02 16.386-45.473 31.16-63.875 39.394 8.035-18.813 22.543-49.156 38.672-65.656 8.41-8.606 21.113-17.364 37.75-26.032.265-.14 17.097-6.933 23.394-9.703-7.285 17.977-20.27 45.969-35.941 61.996zm124.015-26.262c16.114 16.48 30.633 46.84 38.668 65.66-18.394-8.23-47.828-22.992-63.87-39.399-15.669-16.027-28.657-44.02-35.938-61.992a462.109 462.109 0 0 0 22.152 9.059c17.242 8.875 30.36 17.847 38.988 26.672zm40.907-23.563c-32.73 0-75.766-16.976-97.79-26.73 22.012-9.754 65.024-26.73 97.79-26.73 32.734 0 78.43 16.937 102.12 26.734-23.683 9.796-69.359 26.726-102.12 26.726zm0 0"
            fill="#fff"
          />
        </svg>
        <span>Rap</span>
      </div>

      <div class="menuItem" onclick="changeColor('#74ebd5', '#acb6e5')">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 64 64"
          width="40"
          height="40"
          fill="white"
        >
          <path
            d="M8.6 45.3a1 1 0 0 0-1.432 0l-3.227 3.31a1 1 0 0 0 0 1.4 38.817 38.817 0 0 0 55.774 0 1 1 0 0 0 0-1.4l-3.08-3.12a1 1 0 0 0-.861-.49h-.041a1 1 0 0 0-.862.493 33 33 0 0 1-4.117 3.518l-3.7-12.023A.993.993 0 0 0 48 36v-5a1 1 0 0 0-1-1H34.85l-.613-4.908 7.114-.684a1 1 0 0 0 .9-1.091l-.436-4.54a.987.987 0 0 0-1.091-.9l-19.44 1.868a30.062 30.062 0 0 0-9.266-15.556l-.993-.889a1 1 0 0 0-1.409.076L6.149 7.222a1 1 0 0 0 .061 1.4 28.057 28.057 0 0 1 8.431 15.093L16 31.5V36a1 1 0 0 0 .988 1L13.22 49.238A33.087 33.087 0 0 1 8.6 45.3zm47.147 2.135l1.842 1.865a36.8 36.8 0 0 1-51.527 0l1.831-1.878a34.53 34.53 0 0 0 8.73 6.163l.194.111a.956.956 0 0 0 .182.075 34.194 34.194 0 0 0 14.8 3.356h.036a34.131 34.131 0 0 0 15.262-3.575l.03-.012.03-.017a34.443 34.443 0 0 0 3.421-1.957l.127-.073a1.057 1.057 0 0 0 .1-.085 35.232 35.232 0 0 0 4.941-3.971zM47.192 51.2L42.528 37h2.441l4.043 13.154zM46 32v3H18v-3.584a.991.991 0 0 0-.015-.172L16.947 25.3a3.276 3.276 0 0 0 2.522 1.2 3.049 3.049 0 0 0 .315-.016l1.01-.1 1.134 4.844A1 1 0 0 0 22.9 32h10.185l.227 1.82 1.985-.248L35.1 32zm-13.165-2H23.7l-.9-3.809 9.442-.907zm7.329-7.486l-20.571 1.977a1.281 1.281 0 0 1-.245-2.551l20.57-1.976zM8.283 7.843l2.152-2.385.251.224a28.065 28.065 0 0 1 8.58 14.258l-.11.01a3.287 3.287 0 0 0-2.815 2.283 30.009 30.009 0 0 0-8.058-14.39zM19.079 37h2.437l-4.768 14.354-1.775-1.013zm4.545 0h16.8L45.4 52.151a32.2 32.2 0 0 1-13.57 2.976h-.03a32.239 32.239 0 0 1-13.248-2.845z"
          />
        </svg>
        <span>Bluegrass</span>
      </div>
      <div class="menuItem" onclick="changeColor('#da4453', '#89216b')">
        <svg
          height="40"
          viewBox="-120 0 512 512"
          width="40"
          xmlns="http://www.w3.org/2000/svg"
          fill="white"
        >
          <path
            d="M31.316 300.238c.086.094.137.219.223.305l.078.078.102.066c2.097 2.52 4.324 4.91 6.594 7.262.078.078.113.188.199.266.082.078.144.12.21.18a137.112 137.112 0 0 0 11.18 10.386l-14.918 142.02h-9.386c-9.426 0-17.067 7.64-17.067 17.066v25.598A8.534 8.534 0 0 0 17.066 512H256c4.71 0 8.531-3.82 8.531-8.535v-25.598c0-9.426-7.64-17.066-17.066-17.066h-9.387l-14.922-142.02a137.87 137.87 0 0 0 11.332-10.558c.137-.118.282-.239.383-.34l.086-.094c.074-.078.094-.18.16-.258 2.133-2.226 4.27-4.476 6.23-6.824l.122-.078.176-.188c.148-.152.242-.351.367-.504 39.043-47.382 41.488-115.046 5.976-165.128 11.586-4.336 18.403-16.356 16.172-28.528-2.226-12.168-12.855-20.996-25.226-20.949h-18.04c-5.23-25.402-33.28-45.66-69.18-50.2a25.248 25.248 0 0 0 1.884-9.53C153.598 11.46 142.137 0 128 0c-14.14 0-25.602 11.46-25.602 25.602a25.3 25.3 0 0 0 3.415 12.593c-28.262 7.68-49.231 25.532-53.676 47.137H34.133c-12.399-.086-23.07 8.742-25.309 20.934-2.238 12.195 4.602 24.238 16.219 28.562-35.594 50.215-33.02 118.074 6.273 165.453zm11.348-18.636a16.967 16.967 0 0 1 7.305-13.852 33.746 33.746 0 0 0 18.297 5.316c.793 0 1.535-.136 2.312-.195a36.606 36.606 0 0 0 3.176 6.824 33.753 33.753 0 0 0-12.8 18.887 17.595 17.595 0 0 1-10.7-2.824c-1.914-1.996-3.809-4.012-5.574-6.13a17.848 17.848 0 0 1-2.016-8.026zm76.8-59.735c0-9.426 7.641-17.066 17.067-17.066s17.067 7.64 17.067 17.066a15.7 15.7 0 0 1-.211 2.305 37.703 37.703 0 0 0-16.856 12.004 37.713 37.713 0 0 0-16.86-12.024 16.56 16.56 0 0 1-.206-2.285zm109.009 67.653c-1.762 2.105-3.645 4.105-5.54 6.082a17.584 17.584 0 0 1-10.804 2.945 33.764 33.764 0 0 0-12.8-18.875 36.36 36.36 0 0 0 3.167-6.828c.766.05 1.508.199 2.293.199a33.795 33.795 0 0 0 18.305-5.316 16.989 16.989 0 0 1 7.304 13.875c-.02 2.75-.68 5.46-1.925 7.918zM76.8 307.03c0-.293.074-.582.094-.855a16.7 16.7 0 0 1 8.949-13.774 37.41 37.41 0 0 0 9.386 4.387 40.815 40.815 0 0 0 2.125 26.93c-1.14.308-2.308.492-3.488.547-.57 0-1.14-.032-1.707-.094a121.777 121.777 0 0 1-9.867-4.512 16.873 16.873 0 0 1-5.492-12.629zm39.25 15.461a25.364 25.364 0 0 1-1.653-28.16 16.507 16.507 0 0 1 1.707-2.477 25.352 25.352 0 0 1 18.278-10.152c.742-.07 1.426-.137 2.176-.137s1.433.067 2.261.145a25.588 25.588 0 0 1 18.48 10.504c.52.676.985 1.394 1.395 2.14 7.203 11.754 3.79 27.098-7.715 34.692-11.507 7.59-26.957 4.691-34.93-6.555zm64.855 1.707c-.566.051-1.136.074-1.707.067a16.434 16.434 0 0 1-3.48-.57 40.846 40.846 0 0 0 2.133-26.907 37.458 37.458 0 0 0 9.386-4.402 16.687 16.687 0 0 1 8.942 13.765c0 .297 0 .758.07 1.047a16.607 16.607 0 0 1-5.523 12.45 118.203 118.203 0 0 1-9.82 4.523zm35.414-72.703a17.162 17.162 0 0 1-11.793 4.445 37.837 37.837 0 0 0-14.406-25.703 17.066 17.066 0 0 1 19.188-7.75 17.067 17.067 0 0 1 12.558 16.446 16.756 16.756 0 0 1-5.574 12.535zm-40.379-10.184a21.068 21.068 0 0 1 11.793 18.954v.468c-.199.711-.297 1.442-.3 2.176v.156a20.128 20.128 0 0 1-5.758 11.817 8.47 8.47 0 0 0-.856 1.015l-.445.387a20.457 20.457 0 0 1-10.16 4.93 42.236 42.236 0 0 0-24.32-15.36 21.29 21.29 0 0 1-.829-5.59 20.577 20.577 0 0 1 2.227-9.335 21.158 21.158 0 0 1 15.02-11.614 19.134 19.134 0 0 1 4.085-.382c3.32-.028 6.594.78 9.516 2.355zm-65.007-1.953a21.108 21.108 0 0 1 14.89 11.676 20.47 20.47 0 0 1 2.176 9.23 20.828 20.828 0 0 1-.855 5.567 41.787 41.787 0 0 0-24.395 15.36 21.776 21.776 0 0 1-10.367-5.122l-.094-.093c-.289-.43-.61-.832-.965-1.204a20.16 20.16 0 0 1-5.777-11.785v-.238a8.453 8.453 0 0 0-.195-1.469v-.21c-.02-.286-.02-.571 0-.856a21.511 21.511 0 0 1 25.597-20.906zm-42.36 16.532c-4.422.07-8.699-1.567-11.949-4.567a16.605 16.605 0 0 1-5.426-12.39 17.071 17.071 0 0 1 12.563-16.508 17.07 17.07 0 0 1 19.215 7.812 37.806 37.806 0 0 0-14.403 25.653zm178.89 239.043H25.599v-17.067h221.867zM153.599 460.8h-34.133v-42.668c0-9.426 7.64-17.067 17.066-17.067s17.067 7.641 17.067 17.067zm67.328 0h-50.262v-42.668c0-18.852-15.281-34.133-34.133-34.133s-34.133 15.281-34.133 34.133V460.8H52.137l13.758-130.852c2.558 1.563 5.117 3.09 7.832 4.488.359.208.734.387 1.117.54 3.695 1.875 7.46 3.601 11.332 5.12.234.126.472.239.719.34.203.067.418.137.64.188h.16a134.483 134.483 0 0 0 97.633 0h.067a8.451 8.451 0 0 0 2.78-1.031c3.415-1.403 6.727-2.989 9.993-4.653.266-.093.496-.254.762-.367 2.816-1.457 5.547-3.047 8.242-4.683zm22.691-194.824a34.169 34.169 0 0 0-8.953-10.942 33.806 33.806 0 0 0-29.863-50.234 34.294 34.294 0 0 0-29.98 18.031 36.078 36.078 0 0 0-4.18-.719v-.246c0-18.851-15.282-34.133-34.133-34.133-18.852 0-34.133 15.282-34.133 34.133v.36a40.61 40.61 0 0 0-4.105.765c-7.332-13.808-23.122-20.851-38.293-17.082-15.176 3.774-25.832 17.39-25.844 33.024a33.91 33.91 0 0 0 4.265 16.109 34.202 34.202 0 0 0-8.925 10.934C8.375 223.559 14.57 172.652 45.227 136.535H227.84c30.668 36.11 36.879 87.016 15.793 129.442zM128 17.067c4.71 0 8.531 3.82 8.531 8.535 0 4.71-3.82 8.53-8.531 8.53a8.533 8.533 0 1 1 0-17.066zm8.531 34.132c32.352 0 60.297 14.926 66.824 34.133H69.707c6.527-19.207 34.477-34.133 66.824-34.133zM34.133 102.4h204.8c4.712 0 8.532 3.82 8.532 8.535 0 4.71-3.82 8.53-8.531 8.53H34.133a8.533 8.533 0 1 1 0-17.066zm0 0"
          />
        </svg>
        <span>Pop</span>
      </div>
      <div class="menuItem" onclick="changeColor('#c31432', '#240b36')">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 33.023 33.023"
          fill="white"
          height="40"
          width="40"
        >
          <path
            d="M10.033 33.023a.5.5 0 0 1-.47-.671l5.223-14.359-6.313-1.801a.5.5 0 0 1-.246-.803L21.032.177a.5.5 0 0 1 .863.461l-3.692 12.807 6.347 1.811a.498.498 0 0 1 .243.806l-14.38 16.787a.504.504 0 0 1-.38.174zm-.544-17.581l6.087 1.735a.498.498 0 0 1 .333.651l-4.466 12.278 12.083-14.105-6.079-1.733a.501.501 0 0 1-.344-.619l3.18-11.029L9.489 15.442z"
          />
        </svg>
        <span>Metal</span>
      </div>
    </div>
    <div id="container">
      <svg
        class="logo dn"
        viewBox="0 0 296 364"
        width="200"
        height="200"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          stroke-width="7"
          d="M3.902 108L109 5l182.902 96L281 267l-117.098 21L20 253z"
        />
        <path
          stroke-width="8"
          d="M3.902 108L78 123 109 5M78 123c10 18 38.634 73 85.902 165M78 123l213.902-22M191 112l-28 174M78 123L20 253"
        />
      </svg>
    </div>
    <button id="startButton" onclick="startListening()">Start listening</button>

    <script>
      const totalLines = 512;
      const container = document.getElementById("container");
      const linePieces = [];

      function changeColor(color, color2) {
        linePieces.forEach(line => {
          line.style.background = `linear-gradient(${color}, ${color2})`;
        });
      }
      for (let linePiece = 0; linePiece < totalLines; linePiece++) {
        const piece = document.createElement("div");
        piece.style.cssText = `
          height: 1px;
          width: ${(3 / totalLines) * 100}%;
          position: absolute;
          top: ${Math.cos((linePiece / totalLines) * 2 * Math.PI) * 100}%;
          left: ${Math.sin((linePiece / totalLines) * 2 * Math.PI) * 100}%;
          background: linear-gradient(#B0D4FF, #3E0071);
        `;

        container.appendChild(piece);
        linePieces.push(piece);
      }

      const doDraw = (analyser, frequencyArray) => () => {
        requestAnimationFrame(doDraw(analyser, frequencyArray));

        analyser.getByteFrequencyData(frequencyArray);

        const importantFrequencies = frequencyArray.slice(0, 256);
        [
          ...importantFrequencies.reverse(),
          ...importantFrequencies.reverse()
        ].forEach((frequency, index) => {
          linePieces[index].style.height = 1 + frequency + "px";
        });
      };

      async function startListening() {
        document.getElementById("startButton").classList.toggle("dn");
        document.getElementsByClassName("logo")[0].classList.toggle("dn");
        const stream = await navigator.mediaDevices.getUserMedia({
          audio: true
        });
        window.persistAudioStream = stream;
        const audioContent = new AudioContext();
        const audioStream = audioContent.createMediaStreamSource(stream);
        const analyser = audioContent.createAnalyser();
        audioStream.connect(analyser);
        analyser.fftSize = 1024;
        const frequencyArray = new Uint8Array(analyser.frequencyBinCount);

        doDraw(analyser, frequencyArray)();
      }
    </script>
  </body>
</html>
